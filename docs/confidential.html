<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Interactive mode" href="repl.html" /><link rel="prev" title="Other details for advanced users" href="usage_adv.html" />

    <meta name="generator" content="sphinx-5.2.3, furo 2021.11.23"/>
        <title>Logging and keeping confidential information secret - friendly-traceback 0.7.53</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    
    


<style>
  body {
    --color-code-background: #FFFFFF;
  --color-code-foreground: #101010;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #101010;
  --color-code-foreground: #F4F0EC;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #101010;
  --color-code-foreground: #F4F0EC;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">friendly-traceback 0.7.53</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="_static/friendly_logo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">friendly-traceback 0.7.53</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Begin here</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="beginner.html">Useful information for beginners</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Getting Friendly</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Basic usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage_adv.html">Other details for advanced users</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Logging and keeping confidential information secret</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interactive usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="repl.html">Interactive mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">history()</a></li>
<li class="toctree-l1"><a class="reference internal" href="why.html">why()</a></li>
<li class="toctree-l1"><a class="reference internal" href="what.html">what()</a></li>
<li class="toctree-l1"><a class="reference internal" href="where.html">where()</a></li>
<li class="toctree-l1"><a class="reference internal" href="explain.html">explain()</a></li>
<li class="toctree-l1"><a class="reference internal" href="www.html">www()</a></li>
<li class="toctree-l1"><a class="reference internal" href="friendly_object.html">Friendly object</a></li>
<li class="toctree-l1"><a class="reference internal" href="repl_api.html">Everything about the interactive friendly console</a></li>
<li class="toctree-l1"><a class="reference internal" href="friendly_exec.html">Friendlier exec</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Why import *?</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="import_all.html">Why <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">*</span></code>?</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">IDLE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="idle.html">About IDLE</a></li>
<li class="toctree-l1"><a class="reference internal" href="idle_repl.html">IDLE’s shell</a></li>
<li class="toctree-l1"><a class="reference internal" href="idle_run.html">IDLE: using the editor</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Mu</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mu_about.html">About Mu</a></li>
<li class="toctree-l1"><a class="reference internal" href="mu_install.html">Using with Mu: installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="mu_repl.html">Mu’s REPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="mu_run.html">Mu: executing a program</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other consoles</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="pyrepl.html">Using another REPL</a></li>
<li class="toctree-l1"><a class="reference internal" href="vs_code_repl.html">Visual Studio Code’s terminal</a></li>
<li class="toctree-l1"><a class="reference internal" href="ipython_repl.html">IPython’s console</a></li>
<li class="toctree-l1"><a class="reference internal" href="other_repl.html">Other repl</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Editors and Notebooks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="install_thonny.html">Information for Thonny</a></li>
<li class="toctree-l1"><a class="reference internal" href="editor.html">Using with an editor or IDE</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyter.html">Jupyter notebooks and JupyterLab</a></li>
<li class="toctree-l1"><a class="reference internal" href="vs_code.html">Visual Studio Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="colab.html">Google’s colab</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use in your project/package/library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">Public API</a></li>
<li class="toctree-l1"><a class="reference internal" href="formatter.html">Custom formatter</a></li>
<li class="toctree-l1"><a class="reference internal" href="custom_errors.html">Registering custom error types</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Editor plugins</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Thoughts on design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="design.html">Some thoughts on the design of friendly</a></li>
<li class="toctree-l1"><a class="reference internal" href="themes.html">Themes, Styles, and Colours</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple_tracebacks.html">Multiple tracebacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="idle_colours.html">IDLE’s colours</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">All the tracebacks!</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_en_3.9.html">Friendly tracebacks - Python 3.9</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_en_3.9.html">SyntaxError - Python 3.9</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">En español</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_es.html">Friendly tracebacks - en español</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_es.html">Friendly SyntaxError tracebacks - en español</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">En français</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_fr.html"> Friendly tracebacks - en Français</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_fr.html"> Friendly SyntaxError tracebacks - en Français</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">In italiano</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_it.html">Friendly tracebacks - in italiano</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_it.html">Friendly SyntaxError tracebacks - in italiano</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Русский</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_ru.html">Friendly tracebacks - in Русский</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_ru.html">Friendly SyntaxError tracebacks - in Русский</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">தமிழ் மொழி</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_ta.html">Friendly tracebacks - in தமிழ் மொழி</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_ta.html">Friendly SyntaxError tracebacks - in தமிழ் மொழி</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">בעברית</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_he.html">Friendly tracebacks - בעברית</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_he.html">Friendly SyntaxError tracebacks - בעברית</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">More tracebacks</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="known.html">Generic information about various exceptions</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_en_3.6.html">Friendly tracebacks - Python 3.6 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_en_3.6.html">SyntaxError - Python 3.6 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_en_3.7.html">Friendly tracebacks - Python 3.7 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_en_3.7.html">SyntaxError - Python 3.7 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_en_3.8.html">Friendly tracebacks - Python 3.8 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_en_3.8.html">SyntaxError - Python 3.8 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_en_3.10.html">Friendly tracebacks - Python 3.10 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_en_3.10.html">SyntaxError - Python 3.10 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracebacks_en_3.11.html">Friendly tracebacks - Python 3.11 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_tracebacks_en_3.11.html">SyntaxError - Python 3.11 in English</a></li>
<li class="toctree-l1"><a class="reference internal" href="compare_exceptions.html">Comparing Exception messages between Python versions</a></li>
<li class="toctree-l1"><a class="reference internal" href="compare.html">Comparison between Python versions: SyntaxErrors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribute</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="suggest.html">Suggest an addition</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation_notes.html">Notes on translations - using gettext</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Most of the documentation was written prior to version 0.5 and needs to be
updated. This work has now started for version 0.7 and we aim to have
it completed before version 0.8 is available.</p>
</div>
<section id="logging-and-keeping-confidential-information-secret">
<h1>Logging and keeping confidential information secret<a class="headerlink" href="#logging-and-keeping-confidential-information-secret" title="Permalink to this heading">¶</a></h1>
<p>In some situations, it is useful to log exceptions that are raised
and continue the execution. Since the information cannot be queried
interactively, one might want to capture all the required information
to figure out what went wrong. While friendly_traceback was not initially
designed with this purpose in mind, it is perfectly suitable to use
in such cases.</p>
<p>Let’s look at a fairly detailed example meant for more advanced programmes.
First, here’s the code that we wish to run</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">def</span> <span class="nf">compute_fraction</span><span class="p">(</span><span class="n">numerator</span><span class="p">,</span> <span class="n">denominator</span><span class="p">):</span>
<span class="linenos"> 2</span>    <span class="k">return</span> <span class="n">numerator</span> <span class="o">/</span> <span class="n">denominator</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>
<span class="linenos"> 5</span><span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>
<span class="linenos"> 6</span><span class="n">c</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos"> 7</span><span class="c1"># The following will raise an exception</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">def</span> <span class="nf">fn_1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="linenos">10</span>    <span class="n">d</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span>
<span class="linenos">11</span>    <span class="n">irrelevant</span> <span class="o">=</span> <span class="n">d</span> <span class="o">*</span> <span class="n">e</span>
<span class="linenos">12</span>    <span class="k">return</span> <span class="n">irrelevant</span> <span class="o">+</span> <span class="n">fn_2</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">irrelevant</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="k">def</span> <span class="nf">fn_2</span><span class="p">(</span><span class="n">secret_x</span><span class="p">,</span> <span class="n">secret_y</span><span class="p">):</span>
<span class="linenos">15</span>    <span class="k">return</span> <span class="n">fn_3</span> <span class="p">(</span><span class="n">secret_x</span><span class="p">,</span> <span class="n">secret_y</span><span class="p">)</span>
<span class="linenos">16</span>
<span class="linenos">17</span><span class="k">def</span> <span class="nf">fn_3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="linenos">18</span>    <span class="k">return</span> <span class="n">compute_fraction</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="linenos">19</span>
<span class="linenos">20</span>
<span class="linenos">21</span><span class="n">fraction</span> <span class="o">=</span> <span class="n">fn_1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>At this point, note on line 12 that the <code class="docutils literal notranslate"><span class="pre">fn_2</span></code> function call is
part of an expression between two terms that we named <code class="docutils literal notranslate"><span class="pre">irrelevant</span></code>.
This will be relevant later.</p>
<p>Furthermore, on line 15, we have two variable names beginning with <code class="docutils literal notranslate"><span class="pre">secret</span></code>.</p>
<section id="how-to-use-logging-an-example">
<h2>How to use logging: an example<a class="headerlink" href="#how-to-use-logging-an-example" title="Permalink to this heading">¶</a></h2>
<p>Suppose we wish to run this code and log any exception that arise.
Furthermore, we do not want to reveal what the value of any variable
whose name begins by <code class="docutils literal notranslate"><span class="pre">secret</span></code>, while having as much information as possible
about the state of the program and values of variables when
the exception was raised. Here’s how we can do it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">friendly_traceback</span>
<span class="linenos"> 2</span><span class="kn">from</span> <span class="nn">friendly_traceback.console_helpers</span> <span class="kn">import</span> <span class="n">history</span><span class="p">,</span> <span class="n">where</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">logging</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># Configure as desired before running the code</span>
<span class="linenos"> 6</span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">"ignore.log"</span><span class="p">)</span>
<span class="linenos"> 7</span><span class="n">friendly_traceback</span><span class="o">.</span><span class="n">set_stream</span><span class="p">(</span><span class="n">redirect</span><span class="o">=</span><span class="s2">"capture"</span><span class="p">)</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1"># We don't ever want to show the name</span>
<span class="linenos">10</span><span class="n">friendly_traceback</span><span class="o">.</span><span class="n">hide_secrets</span><span class="p">(</span><span class="n">patterns</span><span class="o">=</span><span class="p">[</span><span class="sa">r</span><span class="s2">"secret\w*"</span><span class="p">])</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="k">try</span><span class="p">:</span>
<span class="linenos">13</span>    <span class="kn">import</span> <span class="nn">example_logging_source</span>
<span class="linenos">14</span><span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
<span class="linenos">15</span>    <span class="n">friendly_traceback</span><span class="o">.</span><span class="n">explain_traceback</span><span class="p">()</span>
<span class="linenos">16</span>    <span class="n">log</span> <span class="o">=</span> <span class="n">friendly_traceback</span><span class="o">.</span><span class="n">get_output</span><span class="p">()</span>
<span class="linenos">17</span>
<span class="linenos">18</span>    <span class="c1"># The following will add some detailed information about variables</span>
<span class="linenos">19</span>    <span class="c1"># in each frame, in case it is relevant</span>
<span class="linenos">20</span>    <span class="n">where</span><span class="p">(</span><span class="n">more</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos">21</span>    <span class="n">where_log</span> <span class="o">=</span> <span class="n">friendly_traceback</span><span class="o">.</span><span class="n">get_output</span><span class="p">()</span>
<span class="linenos">22</span>
<span class="linenos">23</span>    <span class="n">history</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>  <span class="c1"># prevent memory leaks</span>
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="n">full_log</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos">26</span>        <span class="s2">" Output from friendly_traceback</span><span class="se">\n</span><span class="s2">"</span>
<span class="linenos">27</span>        <span class="o">+</span> <span class="n">log</span>
<span class="linenos">28</span>        <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">------More details--------</span><span class="se">\n</span><span class="s2">"</span>
<span class="linenos">29</span>        <span class="o">+</span> <span class="n">where_log</span>
<span class="linenos">30</span>        <span class="o">+</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">======Original traceback=======</span><span class="se">\n</span><span class="s2">"</span>
<span class="linenos">31</span>    <span class="p">)</span>
<span class="linenos">32</span>
<span class="linenos">33</span>    <span class="c1"># exc_info=True below will append the original traceback</span>
<span class="linenos">34</span>    <span class="n">logging</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">full_log</span><span class="p">,</span> <span class="n">exc_info</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<ol class="arabic simple">
<li><p>On line 7 we set friendly_traceback so that its output is (temporarily) captured
rather than printed out.</p></li>
<li><p>On line xxx we add a regular expression pattern identifying variable names whose
value we wish to keep secret.</p></li>
<li><p>On line 10, we extract the content that was captured and, in doing so, clear the buffer
where that content was held. It is possible to pass the argument <code class="docutils literal notranslate"><span class="pre">flush=False</span></code> to
keep that content if needed.</p></li>
<li><p>By default, friendly_traceback gives a “short” traceback, with more details given
for the initial and final frame. On line 20, with <code class="docutils literal notranslate"><span class="pre">where(more=True)</span></code>, we get
friendly_traceback to output detailed information about each frame involved in
the traceback.</p></li>
<li><p>By default, friendly_traceback keeps a copy of each traceback that was generated.
This is sometimes useful in interactive mode, especially if warnings are emitted
as they do not cause an interruption to the program. By calling <code class="docutils literal notranslate"><span class="pre">history.clear()</span></code>
on line 23, we remove this content, helping to reduce the risk of memory leaks.</p></li>
</ol>
</section>
<section id="analysing-the-output">
<h2>Analysing the output<a class="headerlink" href="#analysing-the-output" title="Permalink to this heading">¶</a></h2>
<p>The example described previously yields the following result,
to which we add comments afterwords.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span>ERROR:root: Output from friendly_traceback
<span class="linenos">  2</span>
<span class="linenos">  3</span>Traceback (most recent call last):
<span class="linenos">  4</span>  File "HOME:\example_logging.py", line 13, in &lt;module&gt;
<span class="linenos">  5</span>    import example_logging_source
<span class="linenos">  6</span>       ... More lines not shown. ...
<span class="linenos">  7</span>  File "HOME:\example_logging_source.py", line 18, in fn_3
<span class="linenos">  8</span>    return compute_fraction(x, y)
<span class="linenos">  9</span>  File "HOME:\example_logging_source.py", line 2, in compute_fraction
<span class="linenos"> 10</span>    return numerator / denominator
<span class="linenos"> 11</span>ZeroDivisionError: division by zero
<span class="linenos"> 12</span>
<span class="linenos"> 13</span>    A `ZeroDivisionError` occurs when you are attempting to divide a value
<span class="linenos"> 14</span>    by zero either directly or by using some other mathematical operation.
<span class="linenos"> 15</span>
<span class="linenos"> 16</span>    You are dividing by the following term
<span class="linenos"> 17</span>
<span class="linenos"> 18</span>         denominator
<span class="linenos"> 19</span>
<span class="linenos"> 20</span>    which is equal to zero.
<span class="linenos"> 21</span>
<span class="linenos"> 22</span>    Execution stopped on line `13` of file 'HOME:\example_logging.py'.
<span class="linenos"> 23</span>
<span class="linenos"> 24</span>        9| # We don't ever want to show the name
<span class="linenos"> 25</span>       10| friendly_traceback.hide_secrets(patterns=[r"secret\w*"])
<span class="linenos"> 26</span>       11|
<span class="linenos"> 27</span>       12| try:
<span class="linenos"> 28</span>    --&gt;13|     import example_logging_source
<span class="linenos"> 29</span>       14| except Exception:
<span class="linenos"> 30</span>
<span class="linenos"> 31</span>    Exception raised on line `2` of file 'HOME:\example_logging_source.py'.
<span class="linenos"> 32</span>
<span class="linenos"> 33</span>       1| def compute_fraction(numerator, denominator):
<span class="linenos"> 34</span>    --&gt;2|     return numerator / denominator
<span class="linenos"> 35</span>                     ^^^^^^^^^^^^^^^^^^^^^^^
<span class="linenos"> 36</span>
<span class="linenos"> 37</span>            denominator:  0
<span class="linenos"> 38</span>            numerator:  1
<span class="linenos"> 39</span>
<span class="linenos"> 40</span>
<span class="linenos"> 41</span>------More details--------
<span class="linenos"> 42</span>
<span class="linenos"> 43</span>    File 'HOME:\example_logging.py', line `13`
<span class="linenos"> 44</span>        9| # We don't ever want to show the name
<span class="linenos"> 45</span>       10| friendly_traceback.hide_secrets(patterns=[r"secret\w*"])
<span class="linenos"> 46</span>       11|
<span class="linenos"> 47</span>       12| try:
<span class="linenos"> 48</span>    --&gt;13|     import example_logging_source
<span class="linenos"> 49</span>       14| except Exception:
<span class="linenos"> 50</span>
<span class="linenos"> 51</span>
<span class="linenos"> 52</span>    File 'HOME:\example_logging_source.py', line `21`
<span class="linenos"> 53</span>       15|     return fn_3 (secret_x, secret_y)
<span class="linenos"> 54</span>       16|
<span class="linenos"> 55</span>       17| def fn_3(x, y):
<span class="linenos"> 56</span>       18|     return compute_fraction(x, y)
<span class="linenos"> 57</span>        :
<span class="linenos"> 58</span>    --&gt;21| fraction = fn_1(a, b)
<span class="linenos"> 59</span>                      ^^^^^^^^^^
<span class="linenos"> 60</span>
<span class="linenos"> 61</span>            a:  4
<span class="linenos"> 62</span>            b:  2
<span class="linenos"> 63</span>            fn_1:  &lt;function fn_1&gt;
<span class="linenos"> 64</span>
<span class="linenos"> 65</span>    File 'HOME:\example_logging_source.py', line `12`
<span class="linenos"> 66</span>        9| def fn_1(a, b):
<span class="linenos"> 67</span>       10|     d, e = 4, 5
<span class="linenos"> 68</span>       11|     irrelevant = d * e
<span class="linenos"> 69</span>    --&gt;12|     return irrelevant + fn_2(c, a - b**2) + irrelevant
<span class="linenos"> 70</span>                                   ^^^^^^^^^^^^^^^^^
<span class="linenos"> 71</span>
<span class="linenos"> 72</span>            a:  4
<span class="linenos"> 73</span>            b:  2
<span class="linenos"> 74</span>            global c:  1
<span class="linenos"> 75</span>            global fn_2:  &lt;function fn_2&gt;
<span class="linenos"> 76</span>            a - b**2:  0
<span class="linenos"> 77</span>            b**2:  4
<span class="linenos"> 78</span>
<span class="linenos"> 79</span>    File 'HOME:\example_logging_source.py', line `15`
<span class="linenos"> 80</span>       14| def fn_2(secret_x, secret_y):
<span class="linenos"> 81</span>    --&gt;15|     return fn_3 (secret_x, secret_y)
<span class="linenos"> 82</span>                      ^^^^^^^^^^^^^^^^^^^^^^^^^
<span class="linenos"> 83</span>
<span class="linenos"> 84</span>            secret_x:  '••••••'
<span class="linenos"> 85</span>            secret_y:  '••••••'
<span class="linenos"> 86</span>            global fn_3:  &lt;function fn_3&gt;
<span class="linenos"> 87</span>
<span class="linenos"> 88</span>    File 'HOME:\example_logging_source.py', line `18`
<span class="linenos"> 89</span>       17| def fn_3(x, y):
<span class="linenos"> 90</span>    --&gt;18|     return compute_fraction(x, y)
<span class="linenos"> 91</span>                      ^^^^^^^^^^^^^^^^^^^^^^
<span class="linenos"> 92</span>
<span class="linenos"> 93</span>            x:  1
<span class="linenos"> 94</span>            y:  0
<span class="linenos"> 95</span>            global compute_fraction:  &lt;function compute_fraction&gt;
<span class="linenos"> 96</span>
<span class="linenos"> 97</span>    File 'HOME:\example_logging_source.py', line `2`
<span class="linenos"> 98</span>       1| def compute_fraction(numerator, denominator):
<span class="linenos"> 99</span>    --&gt;2|     return numerator / denominator
<span class="linenos">100</span>                     ^^^^^^^^^^^^^^^^^^^^^^^
<span class="linenos">101</span>
<span class="linenos">102</span>            denominator:  0
<span class="linenos">103</span>            numerator:  1
<span class="linenos">104</span>
<span class="linenos">105</span>
<span class="linenos">106</span>======Original traceback=======
<span class="linenos">107</span>Traceback (most recent call last):
<span class="linenos">108</span>  File "C:\Users\Andre\example_logging.py", line 13, in &lt;module&gt;
<span class="linenos">109</span>    import example_logging_source
<span class="linenos">110</span>  File "C:\Users\Andre\example_logging_source.py", line 21, in &lt;module&gt;
<span class="linenos">111</span>    fraction = fn_1(a, b)
<span class="linenos">112</span>  File "C:\Users\Andre\example_logging_source.py", line 12, in fn_1
<span class="linenos">113</span>    return irrelevant + fn_2(c, a - b**2) + irrelevant
<span class="linenos">114</span>  File "C:\Users\Andre\example_logging_source.py", line 15, in fn_2
<span class="linenos">115</span>    return fn_3 (secret_x, secret_y)
<span class="linenos">116</span>  File "C:\Users\Andre\example_logging_source.py", line 18, in fn_3
<span class="linenos">117</span>    return compute_fraction(x, y)
<span class="linenos">118</span>  File "C:\Users\Andre\example_logging_source.py", line 2, in compute_fraction
<span class="linenos">119</span>    return numerator / denominator
<span class="linenos">120</span>ZeroDivisionError: division by zero
</pre></div>
</div>
<ol class="arabic">
<li><p><strong>friendly-traceback</strong> uses Alex Hall’s <a class="reference external" href="https://github.com/alexmojaki/executing">executing</a>
to narrow down the parts of the code in a traceback to those that are involved in
generating an exception. For example, look at line 69 above where the part highlighted by
carets (<code class="docutils literal notranslate"><span class="pre">^</span></code>) does not include the variable name <code class="docutils literal notranslate"><span class="pre">irrelevant</span></code>.
Lines 72 to 79 shows the value of various relevant objects in this highlighted
part.  <strong>Please see the note at the bottom of this page</strong> which includes
two questions.</p>
<p>While cPython 3.11 does include such highlighting of relevant code regions in traceback,
it only shows one line per frame. By contrast, <strong>Friendly</strong> will show relevant parts
of a statement even it if spans multiple lines. Furthermore, it does so for Python
version 3.6 and greater.</p>
</li>
<li><p>Lines 84 and 85 shows that two variables, <code class="docutils literal notranslate"><span class="pre">secret_1</span></code> and <code class="docutils literal notranslate"><span class="pre">secret_2</span></code>, were involved
in the code included in the traceback. However, since their names are included by
the pattern we declared as being that of confidential variables, their values are
redacted.</p></li>
</ol>
</section>
<section id="about-keeping-secrets">
<h2>About keeping secrets<a class="headerlink" href="#about-keeping-secrets" title="Permalink to this heading">¶</a></h2>
<p><strong>Friendly</strong> gives you the possibility of testing your pattern deemed to be
confidential before you deploy your code. To protect against the possibility
of having some confidential information shown in the “value” of a given
variable, for example, if you have a dict containing keys whose values
should be confidential, <strong>Friendly</strong> will also see if the pattern
appears in the “value” (technically, the <code class="docutils literal notranslate"><span class="pre">repr</span></code>) of the variable
and will redact it if it does. Furthermore, in order to reduce the length
of the display, the “value” will be truncated if it exceeds a certain length.</p>
<p>Here’s a concrete example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">friendly_traceback</span> <span class="k">as</span> <span class="nn">ft</span>

<span class="n">ft</span><span class="o">.</span><span class="n">hide_secrets</span><span class="p">([</span><span class="s2">"secret\w*"</span><span class="p">])</span>
<span class="n">not_secret</span> <span class="o">=</span> <span class="s2">"should be public"</span>
<span class="n">secret1</span> <span class="o">=</span> <span class="s2">"confidential because of the variable name."</span>
<span class="n">hidden</span> <span class="o">=</span> <span class="s2">"contains a secret."</span>
<span class="n">long_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">))</span>
<span class="k">def</span> <span class="nf">fn</span><span class="p">():</span> <span class="o">...</span>

<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">true_repr</span> <span class="ow">in</span> <span class="p">[</span>
    <span class="p">(</span><span class="s2">"not_secret"</span><span class="p">,</span> <span class="n">not_secret</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"secret1"</span><span class="p">,</span> <span class="n">secret1</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"hidden"</span><span class="p">,</span> <span class="n">hidden</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"long_list"</span><span class="p">,</span> <span class="n">long_list</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">"fn"</span><span class="p">,</span> <span class="n">fn</span><span class="p">)</span>
<span class="p">]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">true_repr</span><span class="si">=}</span><span class="s2">"</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">ft</span><span class="o">.</span><span class="n">test_secrets</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"display by friendly_traceback:</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">)</span>
</pre></div>
</div>
<p>And here’s the corresponding result:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>not_secret: true_repr='should be public'
display by friendly_traceback:
     not_secret:  'should be public'

secret1: true_repr='confidential because of the variable name.'
display by friendly_traceback:
     secret1:  '••••••'

hidden: true_repr='contains a secret.'
display by friendly_traceback:
     hidden:  '••••••'

long_list: true_repr=[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
display by friendly_traceback:
     long_list:  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, ...]
            len(long_list): 100


fn: true_repr=&lt;function fn at 0x0000026D56C5F160&gt;
display by friendly_traceback:
     fn:  &lt;function fn&gt;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>For those that use logging, would it be useful to have the option to show the value <strong>all</strong> the
variables involved in a given frame, like what is done by <code class="docutils literal notranslate"><span class="pre">rich.traceback</span></code> and other
“traceback enhancers”?</p></li>
<li><p>As mentioned, the “value” (<code class="docutils literal notranslate"><span class="pre">repr</span></code>) shown is truncated if it exceeds a certain length.
Would it be useful for this length to be adjustable?</p></li>
</ol>
<p>If you have any opinion on any or both of these two questions, please feel free to open
up an issue for discussion.</p>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="repl.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Interactive mode</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="usage_adv.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Other details for advanced users</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; André Roberge |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="_sources/confidential.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Logging and keeping confidential information secret</a><ul>
<li><a class="reference internal" href="#how-to-use-logging-an-example">How to use logging: an example</a></li>
<li><a class="reference internal" href="#analysing-the-output">Analysing the output</a></li>
<li><a class="reference internal" href="#about-keeping-secrets">About keeping secrets</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    </body>
</html>